# OCR

We will implement functionality for running OCR on maps to detect all text on them, and use an AI model to interpret the detected groups of text and parse them into a data structure to be used when storing the map in the database. The functionality doesn't have to be perfect, but make a reasonable best guess.

We will need the following:

- OCR for map images, to extract all groups of text on it, for internal use
- API integration with a suitable OpenAI model to parse the *text* received from this OCR process into a data structure containing the information we want
- The output of this process must have sane default values if parsing fails for any reason
- The routine will be called when a new map is saved to the database, and also in a separate utility script that will run it against selected maps in the database (all maps or specific maps, by name or database ID range)
- Here is the information we will have the AI model extract from OCR. I will manually review the prompt after you've written the code, so make sure it can be configured:

-- Map area name (map area field in DB)
-- Event name (map event field in DB)
-- Event date (map date field in DB)
-- Scale / MÃ¥lestokk (usually on the form 1:XXXX)
-- Which course the map is for (typically A, B, C, H17, K40, A-OPEN or similar by orienteering convention) (map course field in DB)
-- Credits for who created the map, denoted in a single string with both creator names and manual inspection/synfaring names (map_attribution field in DB)

OCR will probably return a lot of disconnected numbers denoting controls and control descriptions, in addition to text. The text is usually computer-printed, but will be located in different locations of the image. Numbers may have decimal separators.
